"use strict";(globalThis.webpackChunkweb_stories_wp=globalThis.webpackChunkweb_stories_wp||[]).push([[8234],{"./packages/wp-dashboard/src/components/editorSettings/archive/stories/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{_default:()=>_default,default:()=>stories});var react=__webpack_require__("./node_modules/react/index.js");function _extends(){return _extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}var FeatureFlagsContext=(0,react.createContext)({});function transformFlags(features){return Array.isArray(features)?Object.fromEntries(features.map((function(feature){return[feature,!0]}))):features}function FlagsProvider(_ref){var a,b,_ref$features=_ref.features,features=void 0===_ref$features?{}:_ref$features,children=_ref.children,currentFeatures=useFeatures();return(0,react.createElement)(FeatureFlagsContext.Provider,{value:(a=transformFlags(currentFeatures),b=transformFlags(features),_extends({},a,b))},children)}function useFeatures(){return(0,react.useContext)(FeatureFlagsContext)}var src=__webpack_require__("./packages/react/src/index.ts"),i18n=__webpack_require__("./packages/i18n/src/i18n.ts"),translateWithMarkup=__webpack_require__("./packages/i18n/src/translateWithMarkup.tsx"),sprintf=__webpack_require__("./packages/i18n/src/sprintf.ts"),types=__webpack_require__("./packages/design-system/src/theme/types.ts"),dropdown=__webpack_require__("./packages/design-system/src/components/dropDown/dropdown.tsx"),search=__webpack_require__("./packages/design-system/src/components/search/search.tsx"),tracking_src=__webpack_require__("./packages/tracking/src/index.ts"),styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),dashboard_src=__webpack_require__("./packages/dashboard/src/index.js"),components=__webpack_require__("./packages/wp-dashboard/src/components/editorSettings/components.js"),constants=__webpack_require__("./packages/wp-dashboard/src/constants/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const TEXT={LABEL:(0,i18n.__)("Stories Archives","web-stories"),SECTION_HEADING:(0,i18n.__)("Stories Archives","web-stories"),ARCHIVE_CONTENT:(0,i18n.__)("By default WordPress automatically creates an archive page, displaying your latest stories in your theme's layout.","web-stories"),ARCHIVE_CONTENT_2:(0,i18n.__)("You can customize or disable this behavior.","web-stories"),SUB_TEXT_CUSTOM:(0,i18n.__)("Choose a page to serve as your Web Stories archive. Use the Web Stories block to add stories to this page.","web-stories")},OPTIONS=[{label:(0,i18n._x)("Default","archive type","web-stories"),value:constants.bV.DEFAULT},{label:(0,i18n.__)("Disabled","web-stories"),value:constants.bV.DISABLED},{label:(0,i18n.__)("Create your own","web-stories"),value:constants.bV.CUSTOM}],SearchWrapper=styled_components_browser_esm.ZP.div.withConfig({displayName:"archive__SearchWrapper",componentId:"sc-u9kj1r-0"})(["padding-top:12px;"]);function ArchiveSettings({archive=constants.bV.DEFAULT,archiveURL:_archiveURL,defaultArchiveURL,archivePageId,updateSettings,searchPages,getPageById}){const[archiveURL,setArchiveURL]=(0,src.eJ)(_archiveURL),[selectedPage,setSelectedPage]=(0,src.eJ)(archivePageId?{value:archivePageId}:void 0),[searchOptions,setSearchOptions]=(0,src.eJ)([]),onChangeArchive=(0,src.I4)(((_,newArchive)=>{setArchiveURL(_archiveURL);const newArchivePageId=newArchive===constants.bV.CUSTOM?archivePageId:0;setSelectedPage(newArchivePageId),updateSettings({archive:newArchive,archivePageId:newArchivePageId})}),[updateSettings,archivePageId,_archiveURL]),onChangeArchivePageId=(0,src.I4)(((_,newArchivePage)=>{const newValue=Number(newArchivePage.value);newValue!==archivePageId&&(setSelectedPage(newValue?{value:newValue}:void 0),updateSettings({archivePageId:newValue}))}),[archivePageId,updateSettings]);(0,src.d4)((()=>{let mounted=!0;return archivePageId&&constants.bV.CUSTOM===archive&&(async()=>{const{title,link}=await getPageById(archivePageId);if(mounted&&title){const newOption={value:archivePageId,label:title};setSearchOptions((options=>[newOption,...options])),setSelectedPage(newOption),setArchiveURL(link)}})(),()=>{mounted=!1}}),[archive,archivePageId,getPageById]);const handleSearchChange=(0,src.y1)((async value=>{await(0,tracking_src.L9)("archive_page_search",{search_type:"dashboard",search_term:value}),setSearchOptions(await searchPages(value))}),dashboard_src.p$);return(0,jsx_runtime.jsxs)(components.O3,{children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(components.B5,{children:TEXT.SECTION_HEADING}),(0,jsx_runtime.jsx)(components.rJ,{size:types.TextSize.Small,children:TEXT.ARCHIVE_CONTENT}),(0,jsx_runtime.jsx)(components.rJ,{size:types.TextSize.Small,children:TEXT.ARCHIVE_CONTENT_2})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(dropdown.Z,{ariaLabel:TEXT.LABEL,options:OPTIONS,selectedValue:archive,onMenuItemClick:onChangeArchive,fillWidth:!0}),constants.bV.DISABLED===archive&&(0,jsx_runtime.jsx)(components.rJ,{size:types.TextSize.Small,children:(0,jsx_runtime.jsx)(translateWithMarkup.Z,{mapping:{code:(0,jsx_runtime.jsx)("code",{})},children:(0,sprintf.Z)((0,i18n.__)("Turn off the default archive page at <code>%s</code>. Users will see a 404 Not Found page when trying to access the default archive page.","web-stories"),archiveURL)})}),constants.bV.CUSTOM===archive&&(0,jsx_runtime.jsx)(components.rJ,{size:types.TextSize.Small,children:TEXT.SUB_TEXT_CUSTOM}),constants.bV.CUSTOM===archive&&(0,jsx_runtime.jsx)(SearchWrapper,{children:(0,jsx_runtime.jsx)(search.Z,{placeholder:(0,i18n.__)("Select page","web-stories"),selectedValue:selectedPage,options:searchOptions,handleSearchValueChange:handleSearchChange,emptyText:(0,i18n.__)("No pages available","web-stories"),onMenuItemClick:onChangeArchivePageId})}),constants.bV.DISABLED!==archive&&(0,jsx_runtime.jsx)(components.rJ,{size:types.TextSize.Small,children:(0,jsx_runtime.jsx)(translateWithMarkup.Z,{mapping:{a:(0,jsx_runtime.jsx)(components.Un,{href:archiveURL,rel:"noreferrer",target:"_blank",size:types.TextSize.Small}),code:(0,jsx_runtime.jsx)("code",{})},children:archivePageId&&archiveURL!==defaultArchiveURL?(0,sprintf.Z)((0,i18n.__)("Visit archive page at <a>%1$s</a>. <code>%2$s</code> will automatically redirect to this page.","web-stories"),archiveURL,defaultArchiveURL):(0,sprintf.Z)((0,i18n.__)("Visit archive page at <a>%1$s</a>.","web-stories"),archiveURL)})})]})]})}ArchiveSettings.displayName="ArchiveSettings";const stories={title:"Dashboard/Views/EditorSettings/Archive",component:ArchiveSettings,argTypes:{archive:{options:Object.values(constants.bV),control:"radio"},updateSettings:{action:"updateSettings fired"}},parameters:{controls:{include:["updateSettings","archive"]}}},_default={render:function Render(args){return(0,jsx_runtime.jsx)(FlagsProvider,{children:(0,jsx_runtime.jsx)(ArchiveSettings,{archiveURL:"http://www.example.com/web-stories",defaultArchiveURL:"http://www.example.com/web-stories",archivePageId:0,getPageById:()=>({value:1,label:"Page 1"}),searchPages:()=>[{value:1,label:"Page 1"},{value:1,label:"Page 2"},{value:1,label:"Page 3"}],...args})})}}}}]);